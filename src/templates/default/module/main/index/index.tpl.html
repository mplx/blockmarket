{% extends "body.tpl.html" %}

{% block headjs %}
    <script type="text/javascript">
        $(function() {
            sparkvalues = [{% for item in data.hundret %}{{ item.marketvalue }}{% if loop.last == false %},{% endif %}{% endfor %}]
            $('.hundretsparks').sparkline(sparkvalues);

            $('#twentyfour').highcharts('StockChart', {
                title : { enabled : false },
                navigator: { enabled : false },
                scrollbar: { enabled : false },
                rangeSelector: { enabled: false },
                chart: { height: 340 },
                yAxis: { title: { text: 'Gold Coins' }, opposite: false },
                series: [{
                    name: '{{ data.basic.title}}',
                    data: [{% for item in data.twentyfour %}[{{ item.tstamp }},{{ item.marketvalue }}]{% if loop.last == false %},{% endif %}{% endfor %}],
                    tooltip: { valueDecimals: 4, valueSuffix: ' Gold Coins' }
                }]
            });

            $('#month').highcharts({
                title: { text: '{{ data.basic.title}}', },
                tooltip: { valueDecimals: 4, valueSuffix: ' Gold Coins' },
                chart: { height: 340 },
                yAxis: { title: { text: 'Gold Coins' }, },
                xAxis: {
                    categories: [{% for item in data.month %}'{{ item.bmdate }}'{% if loop.last == false %},{% endif %}{% endfor %}]
                },
                legend: {
                    layout: 'vertical',
                    align: 'right',
                    verticalAlign: 'middle',
                    borderWidth: 0
                },
                series: [{
                    name: 'Minimum',
                    data: [{% for item in data.month %}[{{ item.pricemin }}]{% if loop.last == false %},{% endif %}{% endfor %}]
                }, {
                    name: 'Maximum',
                    data: [{% for item in data.month %}[{{ item.pricemax }}]{% if loop.last == false %},{% endif %}{% endfor %}]
                }, {
                    name: 'Average',
                    data: [{% for item in data.month %}[{{ item.priceavg }}]{% if loop.last == false %},{% endif %}{% endfor %}]
                }]
            });

        });
    </script>
{% endblock %}

{% block blitems %}
    {% if data.favorites is defined %}
        <h2>Favorites</h2>
        <p style="margin-left: 5px" >
        {% for item in data.favorites %}
            {% if item.icon_path is null %}
                <img width="12" height="12" src="/static/img/void.gif" />
            {% else %}
                <img width="12" height="12" src="{{ data.config.wiki_url }}{{ item.icon_path }}" />
            {% endif %}
            <a href="?module=index&action=stock&stockid={{ item.id_stock }}">{{ item.title }}</a>
            <br />
        {% endfor %}
        </p>
    {% endif %}

    <h2>Trade Portal</h2>
    <p style="margin-left: 5px" >
    {% for item in stocks %}
        {% if item.icon_path is null %}
            <img width="12" height="12" src="/static/img/void.gif" />
        {% else %}
            <img width="12" height="12" src="{{ data.config.wiki_url }}{{ item.icon_path }}" />
        {% endif %}
        <a href="?module=index&action=stock&stockid={{ item.id_stock }}">{{ item.title }}</a>
        <br />
    {% endfor %}
    </p>
{% endblock %}

{% block blreceips %}
    &nbsp;
{% endblock %}

{% block blcharts %}
    <h1>
        <script>
            writeAddRemove({{ data.basic.id_stock }});
        </script>
        {{ data.basic.title}}
        <span class="hundretsparks">Loading...</span>
        {% if data.basic.url.icon is defined %}
            <img width="40" height="40" src="{{ data.basic.url.icon }}" />
        {% endif %}
    </h1>

    <p>
        <strong>Marketvalue</strong>:
        {{ data.current.marketvalue}}
        <strong>Coins</strong>:
        {{ data.current.platinumcoins}} Platinum
        {{ data.current.goldcoins}} Gold
        {{ data.current.coppercoins}} Copper
        {% if data.current.units > 1 %}({{ data.current.units }} Units){% endif %}
        {% if data.basic.url.wiki is defined %}
            <a href="{{data.basic.url.wiki}}" rel="nofollow" target="_blank" title="The Blockheads Wiki"><i class="fa fa-globe"></i></a>
        {% endif %}
    </p>

    <div id="twentyfour"></div>
    <div id="month"></div>
{% endblock %}
